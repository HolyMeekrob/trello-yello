<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib\trello.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/action.html">action</a></li>
                                <li><a href="../classes/board.html">board</a></li>
                                <li><a href="../classes/card.html">card</a></li>
                                <li><a href="../classes/checklist.html">checklist</a></li>
                                <li><a href="../classes/label.html">label</a></li>
                                <li><a href="../classes/list.html">list</a></li>
                                <li><a href="../classes/member.html">member</a></li>
                                <li><a href="../classes/notification.html">notification</a></li>
                                <li><a href="../classes/organization.html">organization</a></li>
                                <li><a href="../classes/token.html">token</a></li>
                                <li><a href="../classes/trello.html">trello</a></li>
                                <li><a href="../classes/trelloObj.html">trelloObj</a></li>
                                <li><a href="../classes/webhook.html">webhook</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/trello-yello.html">trello-yello</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: lib\trello.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
const Promise = require(&#x27;bluebird&#x27;);
const R = require(&#x27;Ramda&#x27;);
const Config = require(&#x27;./config&#x27;);
const maps = require(&#x27;./trelloPropertyMaps&#x27;);
const net = require(&#x27;../net/networkService&#x27;);
const trelloFactory = require(&#x27;./trelloFactory&#x27;);

/**
 * An object-oriented wrapper for the Trello API.
 *
 * @module trello-yello
 * @main trello-yello
 */

/**
 * Trello Yello&#x27;s entry point for accessing the Trello API. It serves as both an
 * object factory for Trello objects as well as a platform for performing
 * operations that aren&#x27;t associated with specific Trello objects, such as
 * queries against the Trello search engine.
 * @class trello
 * @constructor
 * @param {Object} params the constructor parameters object
 * @param {String} params.key the application key for accessing Trello
 * @param {String} params.token a valid Trello API token
 */
const trello = (cParams) =&gt; {
	&#x27;use strict&#x27;;

	const { key, token } = cParams;

	if (R.isNil(key) || R.isNil(token)) {
		throw new Error(&#x27;Key, token, and network service are required.&#x27;);
	}

	const config = new Config(key, token, 1);

	/**
	 * Creates a new Trello object for the given type. If the object type is
	 * invalid or if the object type does not allow creation through the API,
	 * then this method resolves to an error.
	 *
	 * @method create
	 * @param {Object} params the method parameters object
	 * @param {String} params.objType the type of Trello object. Please refer to
	 * other documentation for the list of allowed types.
	 * @param {Object} params.initialVals the initial values of the Trello
	 * object
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the newly created trelloObj
	 * object
	 * @private
	 */
	const create = (params) =&gt; {
		const { objType, initialVals, callback } = params;

		if (maps[objType] === undefined) {
			return Promise.reject(new Error(
					&#x27;Object type &#x27; + objType + &#x27; does not exist.&#x27;
			)).nodeify(callback);
		}

		if (!maps[objType].allowCreation) {
			return Promise.reject(new Error(
					&#x27;Object type &#x27; + objType + &#x27; does not allow creation.&#x27;
			)).nodeify(callback);
		}

		return net.post(config, objType, null, initialVals)
				.then(response =&gt; {
					const rawObj = JSON.parse(response.body);
					return Promise.resolve(trelloFactory.createTrelloObject({
						maps,
						objType,
						config,
						id: rawObj.id,
						net,
						initialVals: rawObj,
						objConstructor: trelloFactory.createTrelloObject
					})).nodeify(callback);
				});
	};

	/**
	 * Retrieves an existing Trello object.
	 *
	 * @method get
	 * @param {Object} params the method parameters object
	 * @param {String} params.objType the type of Trello object. Please refer to other
	 * documentation for the list of allowed types.
	 * @param {String} params.id the ID of the Trello object
	 * @return {Object} the retrieved trelloObj object
	 */
	const get = (params) =&gt; {
		const { objType, id } = params;
		if (R.isNil(id)) {
			throw new Error(&#x27;Must supply a valid object type and id.&#x27;);
		}
		return trelloFactory.createTrelloObject({
			maps,
			objType,
			config,
			id,
			net,
			objConstructor: trelloFactory.createTrelloObject
		});
	};

	////////////////////////////////////////////////////////////////////////////
	//															PUBLIC METHODS														//
	////////////////////////////////////////////////////////////////////////////

	/**
	 * @method createBoard
	 * @param {Object} params the method parameters object
	 * @param {String} params.name the board&#x27;s name
	 * @param {String} [params.description] the board&#x27;s description
	 * @param {String} [params.organizationId] the board&#x27;s organization
	 * @param {String} [params.cloneId] the id of the existing board to clone
	 * @param {String} [params.keepFromSource=&#x27;all&#x27;] a comma-separated list of
	 * properties to keep from the source board, or &#x27;all&#x27;
	 * @param {String} [params.powerUps] the powerUps to give the new board. This
	 * is a comma separated list of values that can include &#x27;calendar&#x27;,
	 * &#x27;cardAging&#x27;, &#x27;recap&#x27;, and &#x27;voting&#x27;.
	 * @param {String} [params.permissionLevel=&#x27;default&#x27;] the permissions level
	 * of the board. Valid values are &#x27;org&#x27;, &#x27;private&#x27;, and &#x27;public&#x27;.
	 * @param {String} [params.voting=&#x27;disabled&#x27;] the board permissions for
	 * voting. Valid values are &#x27;disabled&#x27;, &#x27;members&#x27;, &#x27;observers&#x27;, &#x27;org&#x27;, and
	 * &#x27;public&#x27;.
	 * @param {String} [params.comments=&#x27;members&#x27;] the board permissions for
	 * commenting. Valid values are &#x27;disabled&#x27;, &#x27;members&#x27;, &#x27;observers&#x27;, &#x27;org&#x27;,
	 * and &#x27;public&#x27;.
	 * @param {String} [params.invitations=&#x27;members&#x27;] the board permissions for
	 * sending invitations. Valid values are &#x27;admins&#x27; and &#x27;members&#x27;.
	 * @param {Boolean} [params.selfJoin=true] the board permissions for allowing
	 * members to self join
	 * @param {Boolean} [params.cardCovers=true] the board setting for card
	 * covers.
	 * @param {String} [params.background=&#x27;blue&#x27;] the board&#x27;s background
	 * @param {String} [params.cardAging=&#x27;regular&#x27;] the board&#x27;s card aging
	 * setting. Valid values are &#x27;regular&#x27; and &#x27;pirate&#x27;.
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the new board
	 */
	const createBoard = (params) =&gt; {
		const initialVals = {
			name: params.name,
			desc: params.description,
			idOrganization: params.organizationId,
			idBoardSource: params.cloneId,
			keepFromSource: params.keepFromSource,
			powerUp: params.powerUps,
			prefs_permissionLevel: params.permissionLevel,
			prefs_voting: params.voting,
			prefs_comments: params.comments,
			prefs_invitations: params.invitations,
			prefs_selfJoin: params.selfJoin,
			prefs_cardCovers: params.cardCovers,
			prefs_background: params.background,
			prefs_cardAging: params.cardAging
		};

		const args = {
			objType: &#x27;board&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createCard
	 * @param {Object} params the method parameters object
	 * @param {String} params.name the card&#x27;s name
 	 * @param {String} params.listId the id of the list the card will be added to
	 * @param {String} [params.description] the card&#x27;s description
	 * @param {String | Number} [params.position=&#x27;bottom&#x27;] the card&#x27;s position.
	 * This can be &#x27;top&#x27;, &#x27;bottom&#x27;, or a positive number.
	 * @param {Date} [params.dueDate] the card&#x27;s due date. If not included, it won&#x27;t
	 * have a due date.
	 * @param {String} [params.labels] a comma-separated list of colors, or &#x27;all&#x27;
	 * @param {String} [params.memberIds] a comma-separated list of member id&#x27;s
	 * that will be assigned to the card
	 * @param {String} [params.labelIds] a comma-separated list of label id&#x27;s
	 * that will be assigned to the card
	 * @param {String} [params.urlSource] if included, a URL starting with
	 * http:// or https://
	 * @param {File} [params.fileSource] a file
	 * @param {String} [params.sourceCardId] the id of the card to clone
	 * @param {String} [params.keepFromSource=&#x27;all&#x27;] a comma-separated list of
	 * properties to keep from the source card, or &#x27;all&#x27;
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the new card
	 */
	const createCard = (params) =&gt; {
		const initialVals = {
			name: params.name,
			desc: params.description,
			pos: params.position,
			due: params.dueDate,
			labels: params.labels,
			idList: params.listId,
			idMembers: params.memberIds,
			idLabels: params.labelIds,
			urlSource: params.urlSource,
			fileSource: params.fileSource,
			idCardSource: params.sourceCardId,
			keepFromSource: params.keepFromSource
		};

		const args = {
			objType: &#x27;card&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createChecklist
	 * @param {Object} params the method parameters object
	 * @param {String} params.name the checklist&#x27;s name
	 * @param {String} [params.boardId] the id of the checklist&#x27;s board
	 * @param {String} [params.cardId] the id of the checklist&#x27;s card
	 * @param {String | Number} [params.position=&#x27;bottom&#x27;] the checklist&#x27;s
	 * position. Valid values are &#x27;top&#x27;, &#x27;bottom&#x27;, or a positive number.
	 * @param {String} [params.cloneId] the id of a checklist to clone
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the new checklist
	 */
	const createChecklist = (params) =&gt; {
		const initialVals = {
			name: params.name,
			idBoard: params.boardId,
			idCard: params.cardId,
			pos: params.position,
			idChecklistSource: params.cloneId
		};

		const args = {
			objType: &#x27;checklist&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createLabel
	 * @param {Object} params the method parameters object
	 * @param {String} params.name the label&#x27;s name
 	 * @param {String} params.color the label&#x27;s color
	 * @param {String} params.boardId the id of the label&#x27;s board
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the new label
	 */
	const createLabel = (params) =&gt; {
		const initialVals = {
			name: params.name,
			color: params.color,
			idBoard: params.boardId
		};

		const args = {
			objType: &#x27;label&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createList
	 * @param {Object} params the method parameters object
	 * @param {String} params.name the list&#x27;s name
	 * @param {String} params.boardId the id of the list&#x27;s board
	 * @param {String} [params.cloneId] the id of the list to clone
	 * @param {String | Number} [params.position=&#x27;top&#x27;] the position of the list.
	 * Valid values are &#x27;top&#x27;, &#x27;bottom&#x27;, or a positive number.
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} a Promise that resolves to the new list
	 */
	const createList = (params) =&gt; {
		const initialVals = {
			name: params.name,
			idBoard: params.boardId,
			idListSource: params.cloneId,
			pos: params.position
		};

		const args = {
			objType: &#x27;list&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createOrganization
	 * @param {Object} params the method parameters object
	 * @param {String} [params.name] the organization&#x27;s name
	 * @param {String} [params.displayName] the organization&#x27;s display name
	 * @param {String} [params.description] the organization&#x27;s description
	 * @param {String} [params.website] the organization&#x27;s website. Must be a
	 * valid URL starting with &#x27;http://&#x27;, &#x27;https://&#x27;, or null.
	 * @return {Object} a Promise that resolves to the new organization
	 */
	const createOrganization = (params) =&gt; {
		const initialVals = {
			name: params.name,
			displayName: params.displayName,
			desc: params.description,
			website: params.website
		};

		const args = {
			objType: &#x27;organization&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method createWebhook
	 * @param params the method parameters object
	 * @param {String} params.watchId the id of the model to watch
	 * @param {String} params.callbackUrl the url of the webhook&#x27;s callback
	 * @param {String} [params.description] the description of the webhook
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete
	 * @return {Object} a Promise that resolves to the new webhook object
	 */
	const createWebhook = (params) =&gt; {
		const initialVals = {
			idModel: params.watchId,
			callbackURL: params.callbackUrl,
			description: params.description
		};

		const args = {
			objType: &#x27;webhook&#x27;,
			initialVals,
			callback: params.callback
		};

		return create(args);
	};

	/**
	 * @method getAction
	 * @param {String} actionId the id of the action
	 * @return {Object} the action object
	 */
	const getAction = (actionId) =&gt; {
		return get({ objType: &#x27;action&#x27;, id: actionId });
	};

	/**
	 * @method getBoard
	 * @param {String} boardId the id of the board
	 * @return {Object} the board object
	 */
	const getBoard = (boardId) =&gt; {
		return get({ objType: &#x27;board&#x27;, id: boardId });
	};

	/**
	 * @method getCard
	 * @param {String} cardId the id of the card
	 * @return {Object} the card object
	 */
	const getCard = (cardId) =&gt; {
		return get({ objType: &#x27;card&#x27;, id: cardId });
	};

	/**
	 * @method getChecklist
	 * @param {String} checklistId the id of the checklist
	 * @return {Object} the checklist object
	 */
	const getChecklist = (checklistId) =&gt; {
		return get({ objType: &#x27;checklist&#x27;, id: checklistId });
	};

	/**
	 * @method getLabel
	 * @param {String} labelId the id of the label
	 * @return {Object} the label object
	 */
	const getLabel = (labelId) =&gt; {
		return get({ objType: &#x27;label&#x27;, id: labelId });
	};

	/**
	 * @method getList
	 * @param {String} listId the id of the list
	 * @return {Object} the list object
	 */
	const getList = (listId) =&gt; {
		return get({ objType: &#x27;list&#x27;, id: listId });
	};

	/**
	 * @method getMember
	 * @param {String} memberId the id of the member
	 * @return {Object} the member object
	 */
	const getMember = (memberId) =&gt; {
		return get({ objType: &#x27;member&#x27;, id: memberId });
	};

	/**
	 * @method getNotification
	 * @param {String} notificationId the id of the notification
	 * @return {Object} the notification object
	 */
	const getNotification = (notificationId) =&gt; {
		return get({ objType: &#x27;notification&#x27;, id: notificationId });
	};

	/**
	 * @method getOrganization
	 * @param {String} organizationId the id of the organization
	 * @return {Object} the organization object
	 */
	const getOrganization = (organizationId) =&gt; {
		return get({ objType: &#x27;organization&#x27;, id: organizationId });
	};

	/**
	 * @method getToken
	 * @param {String} tokenId the id of the token
	 * @return {Object} the token object
	 */
	const getToken = (tokenId) =&gt; {
		return get({ objType: &#x27;token&#x27;, id: tokenId });
	};

	/**
	 * @method getWebhook
	 * @param {String} webhookId the id of the webhook
	 * @return {Object} the webhook object
	 */
	const getWebhook = (webhookId) =&gt; {
		return get({ objType: &#x27;webhook&#x27;, id: webhookId });
	};

	/**
	 * @method getCurrentUser
	 * @return {Object} the member object for the current user
	 */
	const getCurrentUser = () =&gt; {
		return getMember(&#x27;me&#x27;);
	};

	/**
	 * Marks all notifications read by the user.
	 *
	 * @method markAllNotificationsRead
	 * @param {Function} [callback] the callback function once the
	 * operation is complete
	 * @return {Object} a Promise that resolves to a truthy value if successful
	 */
	const markAllNotificationsRead = (callback) =&gt; {
		return net.post(config, &#x27;notification&#x27;, &#x27;all&#x27;, {}, &#x27;read&#x27;).nodeify(callback);
	};

	/**
	 * Runs a query against the Trello search engine.
	 *
	 * @method
	 * @param {Object} params the method parameters object
	 * @param {string} params.query the search query to run
	 * @param {Function} [params.callback] the callback function once the
	 * operation is complete. This is optional, as a Promise is returned.
	 * @return {Object} the query result
	 */
	const search = (params) =&gt; {
		const { query, callback } = params;
		const parameters = {
			query,
			idBoards: &#x27;mine&#x27;,
			modelTypes: &#x27;all&#x27;,
			board_fields: &#x27;all&#x27;,
			boards_limit: &#x27;1000&#x27;,
			card_fields: &#x27;all&#x27;,
			cards_limit: &#x27;1000&#x27;,
			card_board: &#x27;true&#x27;,
			card_list: &#x27;true&#x27;,
			card_members: &#x27;true&#x27;,
			card_stickers: &#x27;true&#x27;,
			card_attachments: &#x27;true&#x27;,
			organization_fields: &#x27;all&#x27;,
			organizations_limit: &#x27;1000&#x27;,
			member_fields: &#x27;all&#x27;,
			members_limit: &#x27;1000&#x27;,
			partial: &#x27;false&#x27;
		};

		return net.get(config, &#x27;search&#x27;, null, parameters)
				.then(response =&gt; Promise.resolve(JSON.parse(response.body))
						.nodeify(callback));
	};

	return Object.freeze({
		createBoard,
		createCard,
		createChecklist,
		createLabel,
		createList,
		createOrganization,
		createWebhook,
		getAction,
		getBoard,
		getCard,
		getChecklist,
		getLabel,
		getList,
		getMember,
		getNotification,
		getOrganization,
		getToken,
		getWebhook,
		getCurrentUser,
		markAllNotificationsRead,
		search
	});
};

module.exports = trello;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
